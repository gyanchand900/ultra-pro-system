<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ultra-Pro Prediction System ‚Äî FINAL</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
/* ===== BASE ===== */
body{margin:0;font-family:Arial;background:#f8fafc;color:#0f172a;padding:14px}
.hidden{display:none}
.card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:14px;margin-bottom:14px}
.nav{display:flex;gap:8px;margin-bottom:10px}
.nav button{flex:1;padding:10px;border-radius:10px;border:1px solid #e5e7eb;background:#fff;font-weight:600;cursor:pointer}
.nav button.active{background:#2563eb;color:#fff}
.flex{display:flex;gap:8px;flex-wrap:wrap}
.stat{flex:1;background:#f1f5f9;border-radius:10px;padding:10px;text-align:center}
.stat span{font-size:12px;color:#64748b}
.stat b{font-size:18px}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;text-align:center;border-bottom:1px solid #e5e7eb}
th{background:#f1f5f9}
.pred{font-weight:800}
.why{font-size:13px;color:#334155;white-space:pre-line;margin-top:6px}
.skip{font-size:12px;color:#b91c1c;margin-top:6px}
.win{color:#16a34a;font-weight:800}
.loss{color:#dc2626;font-weight:800}
.highrisk{color:#b91c1c;font-weight:800}

/* ===== HIGHLIGHTS ===== */
@keyframes glow{0%{box-shadow:inset 0 0 0 rgba(0,0,0,0)}50%{box-shadow:inset 0 0 18px rgba(0,0,0,.15)}100%{box-shadow:inset 0 0 0 rgba(0,0,0,0)}}
.stable{background:#d1fae5}
.break-big{background:#fed7aa}
.break-small{background:#bae6fd}
.fake-big{background:linear-gradient(90deg,#fed7aa,#fee2e2)}
.fake-small{background:linear-gradient(90deg,#bae6fd,#fee2e2)}
.animate .stable,.animate .break-big,.animate .break-small,.animate .fake-big,.animate .fake-small{animation:glow 3.5s infinite;font-weight:700}

/* ===== PREMIUM UI ===== */
.premium .card{border:0;box-shadow:0 10px 30px rgba(15,23,42,.08);background:linear-gradient(180deg,#fff,#f8fafc)}
.premium .stat{background:linear-gradient(180deg,#f8fafc,#eef2ff)}
.premium th{background:#eef2ff}
.premium .nav button.active{background:linear-gradient(90deg,#2563eb,#4f46e5);border:0}
</style>
</head>

<body>

<div class="nav">
  <button class="active" onclick="tab('game')">üéÆ Game</button>
  <button onclick="tab('history')">üìú History</button>
  <button onclick="tab('time')">‚è± Time</button>
</div>

<!-- GAME -->
<div id="game">
  <div class="card flex">
    <div class="stat"><span>Countdown</span><b id="cd">30</b></div>
    <div class="stat"><span>Wallet</span><b id="wallet">‚Çπ1000</b></div>
    <div class="stat"><span>Correct</span><b id="correct">0</b></div>
    <div class="stat"><span>Max Wrong</span><b id="maxWrong">0</b></div>
    <div class="stat"><span>Entries</span><b id="entryCount">0 / 16</b></div>
  </div>

  <div class="card flex">
    <button id="animBtn" onclick="toggleAnimation()">‚ú® Animation: ON</button>
    <button id="uiBtn" onclick="togglePremium()">üíé Premium UI: OFF</button>
  </div>

  <div class="card">
    <div class="pred" id="prediction">Prediction: WAITING</div>
    <div class="why" id="why"></div>
    <div class="skip" id="skip"></div>
  </div>

  <div class="card">
    <table id="tableWrap" class="animate">
      <thead><tr><th>Period</th><th>No.</th><th>Big / Small</th></tr></thead>
      <tbody id="gameTable"></tbody>
    </table>
  </div>
</div>

<!-- HISTORY -->
<div id="history" class="hidden">
  <div class="card">
    <table>
      <thead><tr><th>Period</th><th>Side</th><th>Mode</th><th>Result</th></tr></thead>
      <tbody id="historyTable"></tbody>
    </table>
  </div>
</div>

<!-- TIME -->
<div id="time" class="hidden">
  <div class="card">
    <h3>‚è± Best Prediction Times</h3>
    <table>
      <thead><tr><th>Time</th><th>Total</th><th>Wins</th><th>%</th></tr></thead>
      <tbody id="timeTable"></tbody>
    </table>
  </div>
</div>

<script>
/* ===== TELEGRAM ===== */
const TG_BOT_TOKEN="8297180938:AAHmCdIYnuf2vfidz3wfJXHAOZ9rE5J-lhk";
const TG_CHAT_ID="8455379007";
function sendTelegram(msg){
fetch(`https://api.telegram.org/bot${TG_BOT_TOKEN}/sendMessage`,{
method:"POST",headers:{"Content-Type":"application/json"},
body:JSON.stringify({chat_id:TG_CHAT_ID,text:msg})
});
}

/* ===== CONFIG ===== */
const API="https://draw.ar-lottery01.com/WinGo/WinGo_30S/GetHistoryIssuePage.json";
const BETS=[50,150,250,550];
const MIN_DATA=16;

/* ===== STATE ===== */
let BS=[],lastPeriod=null,cd=30;
let wallet=1000,betIndex=0,pending=null;
let correct=0,wrongStreak=0,maxWrong=0;
let timeStats=JSON.parse(localStorage.getItem("timeStats")||"{}");
let dailyStats=JSON.parse(localStorage.getItem("dailyStats")||"{}");

/* ===== HELPERS ===== */
const bs=n=>n<=4?"Small":"Big";
const nextP=p=>(BigInt(p)+1n).toString();
const nowTime=()=>new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
const today=()=>new Date().toISOString().slice(0,10);

/* ===== DAILY ACCURACY ===== */
function recordDaily(win){
  const d=today(); dailyStats[d]??={t:0,w:0,reported:false};
  dailyStats[d].t++; if(win) dailyStats[d].w++;
  localStorage.setItem("dailyStats",JSON.stringify(dailyStats));
}
function dailyReport(){
  const k=Object.keys(dailyStats).sort(); if(k.length<2) return;
  const y=dailyStats[k[k.length-2]], t=dailyStats[k[k.length-1]];
  if(t.reported) return;
  const ay=y.t?Math.round(y.w/y.t*100):0, at=t.t?Math.round(t.w/t.t*100):0;
  sendTelegram(`üìä DAILY ACCURACY\n‡§ï‡§≤: ${ay}%\n‡§Ü‡§ú: ${at}%\nüìà +${at-ay}%`);
  t.reported=true; localStorage.setItem("dailyStats",JSON.stringify(dailyStats));
}

/* ===== BREAKER STATE ===== */
function marketState(h){
  if(h.length<5) return {state:"WAIT"};
  if(h[0]===h[1]&&h[1]===h[2]) return {state:"STABLE",side:h[0]};
  if(h[4]===h[3]&&h[3]===h[2]&&h[1]!==h[2]&&h[0]===h[2]) return {state:"FAKE",side:h[2]};
  if(h[4]===h[3]&&h[3]===h[2]&&h[1]!==h[2]&&h[0]===h[1]) return {state:"REAL",side:h[1]};
  return {state:"RANDOM"};
}

/* ===== UI TOGGLES ===== */
let animOn=true; function toggleAnimation(){animOn=!animOn; tableWrap.classList.toggle("animate",animOn); animBtn.innerText=animOn?"‚ú® Animation: ON":"‚≠ï Animation: OFF";}
let premiumOn=localStorage.getItem("premiumUI")==="on";
function applyPremium(){document.documentElement.classList.toggle("premium",premiumOn); uiBtn.innerText=premiumOn?"üíé Premium UI: ON":"üíé Premium UI: OFF"; localStorage.setItem("premiumUI",premiumOn?"on":"off");}
function togglePremium(){premiumOn=!premiumOn; applyPremium();}
applyPremium();

/* ===== TIMER ===== */
setInterval(()=>{if(cd>0)cd--; cdEl.textContent=cd},1000);

/* ===== POLL ===== */
async function poll(){
  try{
    const r=await fetch(API,{cache:"no-store"}), j=await r.json();
    const d=j?.data?.list?.[0]; if(!d||d.issueNumber===lastPeriod) return;
    lastPeriod=d.issueNumber; cd=30;
    const num=+d.number, side=bs(num);
    BS.unshift(side); if(BS.length>30) BS.pop();
    entryCount.textContent=`${Math.min(BS.length,MIN_DATA)} / ${MIN_DATA}`;

    const st=marketState(BS);
    let cls="stable";
    if(st.state==="FAKE") cls=st.side==="Big"?"fake-big":"fake-small";
    else if(st.state==="REAL") cls=side==="Big"?"break-big":"break-small";
    gameTable.insertAdjacentHTML("afterbegin",`<tr class="${cls}"><td>${d.issueNumber}</td><td>${num}</td><td>${side}</td></tr>`);
    while(gameTable.children.length>10) gameTable.removeChild(gameTable.lastChild);

    /* resolve */
    if(pending){
      const win=side===pending.s;
      historyTable.rows[0].cells[3].innerHTML=win?'<span class="win">WIN</span>':'<span class="loss">LOSS</span>';
      if(win){
        wallet+=Math.floor(pending.bet*2*0.98); correct++; wrongStreak=0; betIndex=0;
        sendTelegram(`üéâ‚úÖ WIN\nSide: ${pending.s}${pending.mode==="RANDOM"?"\nüî• HIGH RISK":""}`);
      }else{
        wrongStreak++; maxWrong=Math.max(maxWrong,wrongStreak);
        betIndex=Math.min(betIndex+1,BETS.length-1);
        sendTelegram(`üí•‚ùå LOSS\nSide: ${pending.s}`);
      }
      walletEl.textContent="‚Çπ"+wallet; correctEl.textContent=correct; maxWrongEl.textContent=maxWrong;
      recordDaily(win); dailyReport(); pending=null;
    }

    /* auto predict */
    if(!pending && BS.length>=MIN_DATA){
      if(st.state==="STABLE"||st.state==="REAL"){
        const bet=BETS[betIndex]; if(wallet>=bet){
          wallet-=bet; walletEl.textContent="‚Çπ"+wallet;
          pending={s:st.side,bet,mode:st.state};
          prediction.innerHTML=`Prediction: ${st.side}`;
          why.textContent=st.state==="STABLE"?"Stable confirmed":"Real breaker accepted";
          skip.textContent="";
          sendTelegram(`üéØ PREDICTION\nSide: ${st.side}\nMode: ${st.state}\nPeriod: ${nextP(d.issueNumber)}`);
          historyTable.insertAdjacentHTML("afterbegin",`<tr><td>${nextP(d.issueNumber)}</td><td>${st.side}</td><td>${st.state}</td><td>PENDING</td></tr>`);
        }
      }else{
        prediction.textContent="Prediction: SKIP";
        why.textContent=""; skip.textContent=st.state==="FAKE"?"Fake breaker (trap)":"Random / unstable";
      }
    }
  }catch(e){}
}
setInterval(poll,500);

/* ===== TABS ===== */
function tab(id){
  ["game","history","time"].forEach(x=>document.getElementById(x).classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
  document.querySelectorAll(".nav button").forEach(b=>b.classList.remove("active"));
  event.target.classList.add("active");
}

/* ===== DOM ===== */
const cdEl=document.getElementById("cd");
const walletEl=document.getElementById("wallet");
const correctEl=document.getElementById("correct");
const maxWrongEl=document.getElementById("maxWrong");
const entryCount=document.getElementById("entryCount");
const prediction=document.getElementById("prediction");
const why=document.getElementById("why");
const skip=document.getElementById("skip");
const gameTable=document.getElementById("gameTable");
const historyTable=document.getElementById("historyTable");
const timeTable=document.getElementById("timeTable");
const tableWrap=document.getElementById("tableWrap");
const animBtn=document.getElementById("animBtn");
const uiBtn=document.getElementById("uiBtn");
</script>
</body>
</html>
