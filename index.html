<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ultra-Pro Prediction System ‚Äì FINAL</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#f8fafc;color:#0f172a;padding:14px}
.hidden{display:none}
.card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:14px;margin-bottom:14px}
.nav{display:flex;gap:8px;margin-bottom:10px}
.nav button{flex:1;padding:10px;border-radius:10px;border:1px solid #e5e7eb;background:#fff;font-weight:600;cursor:pointer}
.nav button.active{background:#2563eb;color:#fff}
.flex{display:flex;gap:8px;flex-wrap:wrap}
.stat{flex:1;background:#f1f5f9;border-radius:10px;padding:10px;text-align:center}
.stat span{font-size:12px;color:#64748b}
.stat b{font-size:18px}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;text-align:center;border-bottom:1px solid #e5e7eb}
th{background:#f1f5f9}
.pred{font-weight:700}
.why{font-size:13px;color:#334155;white-space:pre-line;margin-top:6px}
.skip{font-size:12px;color:#b91c1c;margin-top:6px}
.highrisk{color:#b91c1c;font-weight:700}
.win{color:#16a34a;font-weight:700}
.loss{color:#dc2626;font-weight:700}
@keyframes glow{
0%{box-shadow:inset 0 0 0 rgba(0,0,0,0)}
50%{box-shadow:inset 0 0 18px rgba(0,0,0,.15)}
100%{box-shadow:inset 0 0 0 rgba(0,0,0,0)}}
.stable{background:#d1fae5;animation:glow 3.5s infinite}
.break-big{background:#fed7aa;animation:glow 3.5s infinite}
.break-small{background:#bae6fd;animation:glow 3.5s infinite}
</style>
</head>

<body>

<div class="nav">
<button class="active" onclick="tab('game')">üéÆ Game</button>
<button onclick="tab('history')">üìú History</button>
<button onclick="tab('time')">‚è± Time</button>
</div>

<!-- GAME -->
<div id="game">
<div class="card flex">
<div class="stat"><span>Countdown</span><b id="cd">30</b></div>
<div class="stat"><span>Wallet</span><b id="wallet">‚Çπ1000</b></div>
<div class="stat"><span>Correct</span><b id="correct">0</b></div>
<div class="stat"><span>Max Wrong</span><b id="maxWrong">0</b></div>
<div class="stat"><span>Entries</span><b id="entryCount">0 / 16</b></div>
</div>

<div class="card">
<div class="pred" id="prediction">Prediction: WAITING</div>
<div class="why" id="why"></div>
<div class="skip" id="skip"></div>
</div>

<div class="card">
<table>
<thead><tr><th>Period</th><th>No.</th><th>Big / Small</th></tr></thead>
<tbody id="gameTable"></tbody>
</table>
</div>
</div>

<!-- HISTORY -->
<div id="history" class="hidden">
<div class="card">
<table>
<thead><tr><th>Period</th><th>Side</th><th>Mode</th><th>Result</th></tr></thead>
<tbody id="historyTable"></tbody>
</table>
</div>
</div>

<!-- TIME -->
<div id="time" class="hidden">
<div class="card">
<h3>‚è± Best Prediction Times</h3>
<table>
<thead><tr><th>Time</th><th>Total</th><th>Wins</th><th>%</th></tr></thead>
<tbody id="timeTable"></tbody>
</table>
</div>
</div>

<script>
/* ================= TELEGRAM ================= */
const TG_BOT_TOKEN="8297180938:AAHmCdIYnuf2vfidz3wfJXHAOZ9rE5J-lhk";
const TG_CHAT_ID="8455379007";
function sendTelegram(msg){
fetch(`https://api.telegram.org/bot${TG_BOT_TOKEN}/sendMessage`,{
method:"POST",headers:{"Content-Type":"application/json"},
body:JSON.stringify({chat_id:TG_CHAT_ID,text:msg})
});
}

/* ================= CONFIG ================= */
const API="https://draw.ar-lottery01.com/WinGo/WinGo_30S/GetHistoryIssuePage.json";
const MIN_DATA=16;
const BETS=[50,150,250,550];

/* ================= STATE ================= */
let BS=[],lastPeriod=null,cd=30;
let pending=null;
let wallet=1000,betIndex=0;
let correct=0,wrongStreak=0,maxWrong=0;
let failedStable={};
let timeStats=JSON.parse(localStorage.getItem("timeStats")||"{}");
let bestTimeNotified={};
let preAlert=false;

/* ================= TIMER ================= */
setInterval(()=>{if(cd>0)cd--;cdEl.textContent=cd},1000);

/* ================= HELPERS ================= */
const bs=n=>n<=4?"Small":"Big";
const nextP=p=>(BigInt(p)+1n).toString();
const nowTime=()=>new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});

/* ================= MEMORY ================= */
function breakerMemory(hist){
let b=[];
for(let i=1;i<hist.length;i++){
if(hist[i]!==hist[i-1])b.push(hist[i]);
if(b.length>=10)break;
}
if(b.length<4)return null;
let c={};b.forEach(x=>c[x]=(c[x]||0)+1);
for(let k in c)if(c[k]/b.length>=0.6)return k;
return null;
}
function randomBreaker(hist){
if(hist.length<5)return null;
let h=hist.slice(0,4);
if(h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[3])return h[1];
return null;
}

/* ================= PREDICTION ENGINE ================= */
function predict(hist){
if(hist.length<MIN_DATA)return{a:"SKIP",r:"Market mature nahi"};
const twoSame=hist[0]===hist[1]?hist[0]:null;
const threeSame=hist[0]===hist[1]&&hist[1]===hist[2]?hist[0]:null;
const memKey=hist.slice(0,3).join("-");
if(failedStable[memKey])return{a:"SKIP",r:"Last time yeh pattern fail hua"};
if(twoSame&&!threeSame)return{a:"PREDICT",s:twoSame,m:"EARLY-STABLE",w:"2 same par early entry"};
const br=breakerMemory(hist);
if(threeSame&&br&&threeSame===br)return{a:"PREDICT",s:threeSame,m:"STABLE+BREAKER",w:"Stable + breaker agree"};
if(threeSame)return{a:"PREDICT",s:threeSame,m:"STABLE",w:"Stable confirm"};
if(br)return{a:"PREDICT",s:br,m:"BREAKER",w:"Breaker repeat"};
const rnd=randomBreaker(hist);
if(rnd)return{a:"PREDICT",s:rnd,m:"RANDOM",w:"Zig-zag breaker",risk:true};
return{a:"SKIP",r:"No edge"};
}

/* ================= POLL ================= */
async function poll(){
try{
const r=await fetch(API,{cache:"no-store"});
const j=await r.json();
const d=j?.data?.list?.[0];
if(!d||d.issueNumber===lastPeriod)return;

lastPeriod=d.issueNumber;cd=30;
const num=+d.number,side=bs(num);
BS.unshift(side);if(BS.length>30)BS.pop();
entryCount.textContent=`${Math.min(BS.length,MIN_DATA)} / ${MIN_DATA}`;

/* Resolve previous */
if(pending){
const win=side===pending.s;
historyTable.rows[0].cells[3].innerHTML=win?'<span class="win">WIN</span>':'<span class="loss">LOSS</span>';

if(win){
wallet+=Math.floor(pending.bet*2*0.98);
betIndex=0;correct++;wrongStreak=0;
}else{
betIndex=Math.min(betIndex+1,BETS.length-1);
wrongStreak++;maxWrong=Math.max(maxWrong,wrongStreak);
if(pending.m.includes("STABLE"))failedStable[pending.memKey]=true;
}

timeStats[pending.t].t++;
if(win)timeStats[pending.t].w++;

if(win){
if(pending.m==="RANDOM"){
sendTelegram(
`üî•üéØ HIGH RISK WIN
‚ö†Ô∏è Mode: RANDOM BREAKER
üìà Side: ${pending.s}`
);
}else{
sendTelegram(
`üéâ‚úÖ WIN CONFIRMED
üìà Side: ${pending.s}
Mode: ${pending.m}`
);
}
}else{
sendTelegram(
`üí•‚ùå LOSS HIT
üìâ Side: ${pending.s}
Mode: ${pending.m}`
);
}

pending=null;
walletEl.textContent="‚Çπ"+wallet;
correctEl.textContent=correct;
maxWrongEl.textContent=maxWrong;
}

/* New prediction */
const dcs=predict(BS);
if(dcs.a==="PREDICT"){
const bet=BETS[betIndex];
if(wallet>=bet){
wallet-=bet;walletEl.textContent="‚Çπ"+wallet;
prediction.innerHTML=`Prediction: ${dcs.s} ${dcs.risk?'<span class="highrisk">(HIGH RISK)</span>':''}`;
why.textContent=dcs.w;skip.textContent="";
const t=nowTime();
timeStats[t]??={t:0,w:0};
pending={s:dcs.s,m:dcs.m,t,bet,memKey:BS.slice(0,3).join("-")};
sendTelegram(
`üéØ PREDICTION
Side: ${dcs.s}
Mode: ${dcs.m}
Period: ${nextP(d.issueNumber)}`
);
historyTable.insertAdjacentHTML("afterbegin",
`<tr><td>${nextP(d.issueNumber)}</td><td>${dcs.s}</td><td>${dcs.m}</td><td>PENDING</td></tr>`);
}
}else{
prediction.textContent="Prediction: SKIP";
skip.textContent=dcs.r;why.textContent="";
}

/* Table */
let cls="stable";
if(BS[1]&&BS[0]!==BS[1])cls=side==="Big"?"break-big":"break-small";
gameTable.insertAdjacentHTML("afterbegin",
`<tr class="${cls}"><td>${d.issueNumber}</td><td>${num}</td><td>${side}</td></tr>`);
while(gameTable.children.length>10)gameTable.removeChild(gameTable.lastChild);

/* Time learning */
renderTime();
}catch(e){}
}
setInterval(poll,500);

/* ================= TIME PANEL ================= */
function renderTime(){
timeTable.innerHTML="";
for(const k in timeStats){
const v=timeStats[k],r=v.t?Math.round(v.w/v.t*100):0;
timeTable.insertAdjacentHTML("beforeend",
`<tr><td>${k}</td><td>${v.t}</td><td>${v.w}</td><td>${r}%</td></tr>`);
if(v.t>=5&&r>=70&&!bestTimeNotified[k]){
sendTelegram(`‚è± BEST TIME FOUND\n${k}\nAccuracy: ${r}%`);
bestTimeNotified[k]=true;
}
}
localStorage.setItem("timeStats",JSON.stringify(timeStats));
}

/* ================= UI ================= */
function tab(id){
["game","history","time"].forEach(x=>document.getElementById(x).classList.add("hidden"));
document.getElementById(id).classList.remove("hidden");
document.querySelectorAll(".nav button").forEach(b=>b.classList.remove("active"));
event.target.classList.add("active");
}

/* ================= DOM ================= */
const cdEl=document.getElementById("cd");
const walletEl=document.getElementById("wallet");
const correctEl=document.getElementById("correct");
const maxWrongEl=document.getElementById("maxWrong");
const entryCount=document.getElementById("entryCount");
const prediction=document.getElementById("prediction");
const why=document.getElementById("why");
const skip=document.getElementById("skip");
const gameTable=document.getElementById("gameTable");
const historyTable=document.getElementById("historyTable");
const timeTable=document.getElementById("timeTable");
</script>

</body>
</html>